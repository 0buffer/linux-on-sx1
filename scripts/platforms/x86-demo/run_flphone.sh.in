#!/bin/sh

# run_flphone.sh

# based on: run_pixil.sh
# Copyright 2003, Century Embedded Technologies
# Released under the GPL. 
# 
# This script installs all the nessesary daemons and scripts
# to run Pixil in a Redhat 7.3 environment. 

BASE_DIR=@installdir@
MWDIR=@mwdir@

export MWFONTDIR=$BASE_DIR/share/fonts/
export LD_LIBRARY_PATH=$BASE_DIR/lib:$MWDIR/lib

# Verify that everything exists

if [ ! -x "$MWDIR/bin/nano-X" ]; then 
    echo "Oops - no nano-X binary exists.  Bailing..."
    exit 1
fi

# Start the TBUS server
$BASE_DIR/sbin/tbus-daemon &

# Start the Nano-X server
$MWDIR/bin/nano-X -e -x 176 -y 220 &

# Start up the Nano-X window manager
$BASE_DIR/sbin/nanowm &

sleep 1

# Start Indicator daemon
$BASE_DIR/sbin/indicatord &

#sleep 1

$BASE_DIR/sbin/alarmserver
#sleep 100000

## Welcome back  Shut down pending daemons
killall -TERM -q $BASE_DIR/sbin/alarmserver
killall -TERM -q $BASE_DIR/sbin/indicatord
killall -TERM -q $BASE_DIR/sbin/nanowm
killall -TERM -q $BASE_DIR/sbin/tbus-daemon

# press enter to exit
echo Press Enter to exit
read
